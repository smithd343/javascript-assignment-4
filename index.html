<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<style>
		body {
			font-family: Arial, Helvetica, sans-serif;
		}

		h2 {
			color: #2f8d46;
			text-align: center;
		}

		p {
			color: #333333;
			text-align: center;
		}
	</style>
	<script>
		function sleep(ms) {
    		return new Promise(resolve => setTimeout(resolve, ms));
		}
 		async function dance() {
			var date = new Date();
			console.log(date.toISOString() + " dance start");
			await sleep(11000);
			var date = new Date();
			console.log(date.toISOString() + " dance end");
		}
		async function danceAgain() {
			var date = new Date();
			console.log(date.toISOString() + " danceAgain start");
			await sleep(44000);
			var date = new Date();
			console.log(date.toISOString() + " danceAgain end");
		};
		async function work() {
			var date = new Date();
			console.log(date.toISOString() + " work start");
			await sleep(4000);
			var date = new Date();
			console.log(date.toISOString() + " work end");
		};

		async function doSomething() {
			var date = new Date();
			console.log(date.toISOString() + " doSomething start");
			let A = await dance();       // takes 11 seconds
			let B = await danceAgain();  // takes 44 seconds
			let C = await work();        // takes 4 seconds
			var date = new Date();
			console.log(date.toISOString() + " doSomething end");
			return doSomethingElse();
		}

		async function doSomethingElse() {
			var date = new Date();
			console.log(date.toISOString() + " doSomethingElse start");
			let results = await Promise.all([dance, danceAgain, work]);
			var date = new Date();
			console.log(date.toISOString() + " doSomethingElse end");
			return results.reduce((total, value) => total * value);			
		}

		var date = new Date();
		console.log(date.toISOString() + " script start");
		doSomething();
		var date = new Date();
		console.log(date.toISOString() + " script end");
	</script>
</head>

<body>
	<h2>JavaScript Asssignment 4</h2>
	<p>To view the output press F12 to display the console.</p>
</body>

</html>
